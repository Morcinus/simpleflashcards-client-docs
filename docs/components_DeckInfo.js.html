<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href="favicon.ico" />
    <title>Simple Flashcards Docs: components/DeckInfo.js</title>

    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="./build/entry.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
      integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
      crossorigin="anonymous"
    />
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css" />
    <link type="text/css" rel="stylesheet" href="styles/app.min.css" />
    <link type="text/css" rel="stylesheet" href="styles/iframe.css" />
  </head>

  <body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
      <div class="container">
        <nav class="navbar" role="navigation" aria-label="main navigation">
          <div class="navbar-brand">
            <h1 class="navbar-item">Simple Flashcards frontend dokumentace</h1>

            <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>

          <div class="navbar-menu">
            <div class="navbar-end">
              <div class="navbar-item">
                <a href="https://simpleflashcards-4aea0.firebaseapp.com" target="_blank">
                  Aplikace
                </a>
              </div>

              <div class="navbar-item">
                <a href="https://github.com/Morcinus/SimpleFlashCards" target="_blank">
                  Github
                </a>
              </div>

              <div class="navbar-item">
                <a href="https://morcinus.github.io/SimpleFlashCards/" target="_blank">
                  O aplikaci
                </a>
              </div>

              <div class="navbar-item">
                <a href="https://morcinus.github.io/simpleflashcards-fb-functions-docs/" target="_blank">
                  Backend dokumentace
                </a>
              </div>

              <div class="navbar-item">
                <a href="https://morcinus.github.io/simpleflashcards-user-docs/" target="_blank">
                  Uživatelské dukumentace
                </a>
              </div>
            </div>
          </div>
        </nav>
      </div>
    </div>
    <div class="container">
      <div class="columns">
        <div class="column is-3" id="sidebarNav">
          <div class="sidebar">
            <nav>
              <h2><a href="index.html">Home</a></h2>
              <div class="category"></div>
              <div class="category">
                <h2>Components</h2>
                <h3>Classes</h3>
                <ul>
                  <li><a href="CollectionDecks.html">CollectionDecks</a></li>
                  <li><a href="CollectionDialog.html">CollectionDialog</a></li>
                  <li><a href="CollectionInfo.html">CollectionInfo</a></li>
                  <li><a href="ColTable.html">ColTable</a></li>
                  <li><a href="DeckCards.html">DeckCards</a></li>
                  <li><a href="DeckInfo.html">DeckInfo</a></li>
                  <li><a href="DeckTable.html">DeckTable</a></li>
                  <li><a href="GlobalErrorAlert.html">GlobalErrorAlert</a></li>
                  <li><a href="Navbar.html">Navbar</a></li>
                  <li><a href="PinnedCollections.html">PinnedCollections</a></li>
                  <li><a href="PinnedDecks.html">PinnedDecks</a></li>
                  <li><a href="UserCollections.html">UserCollections</a></li>
                  <li><a href="UserDecks.html">UserDecks</a></li>
                </ul>
              </div>
              <div class="category">
                <h2>Ostatní</h2>
                <h3>Modules</h3>
                <ul>
                  <li><a href="module-store.html">store</a></li>
                  <li><a href="module-types.html">types</a></li>
                </ul>
              </div>
              <div class="category">
                <h2>Pages</h2>
                <h3>Classes</h3>
                <ul>
                  <li><a href="collection.html">collection</a></li>
                  <li><a href="createDeck.html">createDeck</a></li>
                  <li><a href="deck.html">deck</a></li>
                  <li><a href="editCollection.html">editCollection</a></li>
                  <li><a href="editDeck.html">editDeck</a></li>
                  <li><a href="home.html">home</a></li>
                  <li><a href="login.html">login</a></li>
                  <li><a href="settings.html">settings</a></li>
                  <li><a href="signup.html">signup</a></li>
                  <li><a href="studyCollection.html">studyCollection</a></li>
                  <li><a href="studyDeck.html">studyDeck</a></li>
                  <li><a href="userProfile.html">userProfile</a></li>
                </ul>
              </div>
              <div class="category">
                <h2>ReduxActions</h2>
                <h3>Modules</h3>
                <ul>
                  <li><a href="module-colStudyActions.html">colStudyActions</a></li>
                  <li><a href="module-colUiActions.html">colUiActions</a></li>
                  <li><a href="module-createDeckActions.html">createDeckActions</a></li>
                  <li><a href="module-deckStudyActions.html">deckStudyActions</a></li>
                  <li><a href="module-deckUiActions.html">deckUiActions</a></li>
                  <li><a href="module-editColActions.html">editColActions</a></li>
                  <li><a href="module-editDeckActions.html">editDeckActions</a></li>
                  <li><a href="module-uiStatusActions.html">uiStatusActions</a></li>
                  <li><a href="module-userActions.html">userActions</a></li>
                </ul>
              </div>
              <div class="category">
                <h2>ReduxReducers</h2>
                <h3>Modules</h3>
                <ul>
                  <li><a href="module-colStudyReducer.html">colStudyReducer</a></li>
                  <li><a href="module-colUiReducer.html">colUiReducer</a></li>
                  <li><a href="module-createDeckReducer.html">createDeckReducer</a></li>
                  <li><a href="module-deckStudyReducer.html">deckStudyReducer</a></li>
                  <li><a href="module-deckUiReducer.html">deckUiReducer</a></li>
                  <li><a href="module-editColReducer.html">editColReducer</a></li>
                  <li><a href="module-editDeckReducer.html">editDeckReducer</a></li>
                  <li><a href="module-uiStatusReducer.html">uiStatusReducer</a></li>
                  <li><a href="module-userReducer.html">userReducer</a></li>
                </ul>
              </div>
              <div class="category">
                <h2>util</h2>
                <h3>Modules</h3>
                <ul>
                  <li><a href="module-AuthRoute.html">AuthRoute</a></li>
                  <li><a href="module-functions.html">functions</a></li>
                  <li><a href="module-other.html">other</a></li>
                  <li><a href="module-PrivateRoute.html">PrivateRoute</a></li>
                  <li><a href="module-theme.html">theme</a></li>
                </ul>
              </div>
            </nav>
          </div>
        </div>
        <div class="column is-9-desktop">
          <div class="content" id="main-content-wrapper">
            <header class="page-title">
              <p>Source</p>
              <h1>components/DeckInfo.js</h1>
            </header>

            <section>
              <article>
                <pre class="prettyprint source linenums"><code>import React, { Component, Fragment } from "react";
import { Link } from "react-router-dom";
import PropTypes from "prop-types";

// Material UI
import Grid from "@material-ui/core/Grid";
import Button from "@material-ui/core/Button";
import Divider from "@material-ui/core/Divider";
import Typography from "@material-ui/core/Typography";
import Popover from "@material-ui/core/Popover";
import CardMedia from "@material-ui/core/CardMedia";
import Card from "@material-ui/core/Card";
import Input from "@material-ui/core/Input";
import Box from "@material-ui/core/Box";
import MUILink from "@material-ui/core/Link";
import BookmarkBorderIcon from "@material-ui/icons/BookmarkBorder";
import BookmarkIcon from "@material-ui/icons/Bookmark";
import ShareIcon from "@material-ui/icons/Share";
import EditIcon from "@material-ui/icons/Edit";
import LibraryAddIcon from "@material-ui/icons/LibraryAdd";
import LockIcon from "@material-ui/icons/Lock";
import CircularProgress from "@material-ui/core/CircularProgress";
import withStyles from "@material-ui/core/styles/withStyles";
import Hidden from "@material-ui/core/Hidden";

// Other
import DEFAULT_DECK_IMG_URL from "../util/other";

// Redux
import { connect } from "react-redux";
import { pinDeck, unpinDeck } from "../redux/actions/deckUiActions";
import { openCollectionDialog } from "../redux/actions/colUiActions";

/**
 * @function styles
 * @memberof DeckInfo
 * @description Určuje CSS pro daný komponent.
 * @param {Object} theme - Theme (CSS) celé aplikace.
 */
const styles = theme => ({
  descriptionGrid: {
    [theme.breakpoints.down("md")]: {
      flexDirection: "row"
    }
  }
});

/**
 * @class DeckInfo
 * @extends Component
 * @category Components
 * @classdesc Tento komponent zobrazuje informace o balíčku na stránce daného balíčku. Komponent umožňuje balíček sdílet, připnout ho, přidat ho do kolekce, nebo ho případně upravit.
 * @param {Object} props - Vstupní data pro daný komponent.
 * @property {Object} state - Vnitřní state komponentu.
 * @property {boolean} state.popoverOpen - Určuje, zda-li je otevřeno vyskakovací okno na sdílení balíčku.
 * @property {element} state.anchorEl - Obsahuje element, ke kterému se má přichytit vyskakovací okno při sdílení balíčku.
 * @property {boolean} state.copiedLink - Určuje, zda-li uživatel zkopíroval odkaz na tento balíček.
 * @property {boolean} state.isPinned - Určuje, zda-li je balíček připnut uživatelem.
 *
 * @requires colUiActions~openCollectionDialog
 * @requires deckUiActions~pinDeck
 * @requires deckUiActions~unpinDeck
 * @requires {@link module:store~reducers module:store~reducers.deckUi}
 * @requires {@link module:store~reducers module:store~reducers.uiStatus}
 */
export class DeckInfo extends Component {
  constructor(props) {
    super(props);
    this.state = {
      popoverOpen: false,
      anchorEl: null,
      copiedLink: false,
      isPinned: false
    };
    this.handlePinButtonClick = this.handlePinButtonClick.bind(this);
    this.handleAddToCollection = this.handleAddToCollection.bind(this);
  }

  /**
   * @function handleCopyClick
   * @memberOf DeckInfo
   * @description Zkopíruje do schránky odkaz na balíček.
   * @param {string} elementId - ID vyskakovacího okna.
   */
  handleCopyClick = elementId => {
    /* Kód na zkopírování textu do schránky
        Zdroj: https://stackoverflow.com/a/48908805
        Autor: Kupi
        Datum: 13.03.2020
    */
    let textField = document.createElement("textarea");
    textField.innerText = `${window.location.href}`;
    let parentElement = document.getElementById(elementId);
    parentElement.appendChild(textField);
    textField.select();
    document.execCommand("copy");
    parentElement.removeChild(textField);
    /* konec citovaného kódu */

    this.setState({
      copiedLink: true
    });
  };

  /**
   * @function handlePopoverOpen
   * @memberOf DeckInfo
   * @description Otevře vyskakovací okno na sdílení balíčku.
   * @param {event} event - Událost, která vyvolala spuštění této funkce.
   */
  handlePopoverOpen = event => {
    this.setState({
      popoverOpen: true,
      anchorEl: event.currentTarget
    });
  };

  /**
   * @function handlePopoverClose
   * @memberOf DeckInfo
   * @description Zavře vyskakovací okno na sdílení balíčku.
   */
  handlePopoverClose = () => {
    this.setState({
      popoverOpen: false
    });
  };

  /**
   * @function handlePinButtonClick
   * @memberOf DeckInfo
   * @description Nastaví isPinned v state tohoto komponentu na druhou hodnotu.
   */
  handlePinButtonClick() {
    let prevIsPinned = this.state.isPinned;
    this.setState({
      isPinned: !prevIsPinned
    });
  }

  /**
   * @function handleAddToCollection
   * @memberOf DeckInfo
   * @description Otevře dialogové okno pro přidávání balíčku do kolekcí.
   */
  handleAddToCollection() {
    this.props.openCollectionDialog();
  }

  /**
   * @function componentDidUpdate
   * @memberOf DeckInfo
   * @description Po stažení dat balíčku ze serveru uloží hodnotu isPinned do state tohoto komponentu.
   * @param {Object} prevProps - Předchozí props daného komponentu.
   */
  componentDidUpdate(prevProps) {
    if (this.props.deckUi.deck) {
      if (this.props.deckUi.deck !== prevProps.deckUi.deck) {
        this.setState({
          isPinned: this.props.deckUi.deck.isPinned
        });
      }
    }
  }

  /**
   * @function componentWillUnmount
   * @memberOf DeckInfo
   * @description Pokud byla změněna hodnota isPinned, nahraje změnu na server. Tím buď připne nebo odepne daný balíček.
   */
  componentWillUnmount() {
    if (this.props.deckUi.deck) {
      if (this.props.deckUi.deck.isPinned !== this.state.isPinned) {
        if (this.state.isPinned) {
          this.props.pinDeck(this.props.deckId);
        } else {
          this.props.unpinDeck(this.props.deckId);
        }
      }
    }
  }

  render() {
    const {
      classes,
      uiStatus: { status }
    } = this.props;
    return (
      &lt;Grid>
        {status === "BUSY" &amp;&amp; (
          &lt;React.Fragment>
            &lt;Card
              variant="outlined"
              style={{
                width: "174px",
                height: "204px",
                backgroundColor: "#d9d9d9",
                display: "flex",
                justifyContent: "center",
                alignItems: "center"
              }}
            >
              &lt;CircularProgress />
            &lt;/Card>
          &lt;/React.Fragment>
        )}
        {status === "SUCCESS" &amp;&amp; this.props.deckUi.deck &amp;&amp; (
          &lt;Grid>
            &lt;Grid className={classes.descriptionGrid} container spacing={2}>
              &lt;Grid item>
                &lt;Card
                  variant="outlined"
                  style={{
                    width: "174px",
                    height: "204px"
                  }}
                >
                  &lt;CardMedia
                    style={{ width: "100%", height: "100%" }}
                    image={this.props.deckUi.deck.deckImage ? this.props.deckUi.deck.deckImage : DEFAULT_DECK_IMG_URL}
                  >&lt;/CardMedia>
                &lt;/Card>
              &lt;/Grid>

              &lt;Grid item>
                &lt;Typography variant="h5">
                  {this.props.deckUi.deck.private &amp;&amp; &lt;LockIcon>&lt;/LockIcon>}
                  {this.props.deckUi.deck.deckName}
                &lt;/Typography>

                &lt;Typography>{this.props.deckUi.deck.deckDescription}&lt;/Typography>

                &lt;br />

                &lt;Typography>
                  Created by:{" "}
                  &lt;MUILink to={`/user/${this.props.deckUi.deck.creatorName}`} component={Link}>
                    {this.props.deckUi.deck.creatorName}
                  &lt;/MUILink>
                &lt;/Typography>
              &lt;/Grid>
            &lt;/Grid>

            &lt;Hidden smDown>
              &lt;br />
              &lt;Divider>&lt;/Divider>
            &lt;/Hidden>

            &lt;Grid direction="row" container style={{ marginTop: "20px" }} spacing={1}>
              &lt;Grid item xs={3} md={12} lg={6} container justify="center">
                &lt;Button variant={this.state.isPinned ? "contained" : "outlined"} color="primary" size="large" onClick={this.handlePinButtonClick}>
                  {this.state.isPinned ? (
                    &lt;Fragment>
                      &lt;BookmarkIcon /> &lt;Typography> Pinned&lt;/Typography>
                    &lt;/Fragment>
                  ) : (
                    &lt;Fragment>
                      &lt;BookmarkBorderIcon /> &lt;Typography> Pin&lt;/Typography>
                    &lt;/Fragment>
                  )}
                &lt;/Button>
              &lt;/Grid>

              &lt;Grid item xs={3} md={12} lg={6} container justify="center">
                &lt;Button onClick={this.handlePopoverOpen} variant="outlined" color="primary" size="large">
                  &lt;ShareIcon /> &lt;Typography> Share&lt;/Typography>
                &lt;/Button>
              &lt;/Grid>
              &lt;Popover
                open={this.state.popoverOpen}
                anchorEl={this.state.anchorEl}
                onClose={this.handlePopoverClose}
                anchorOrigin={{
                  vertical: "bottom",
                  horizontal: "center"
                }}
                transformOrigin={{
                  vertical: "top",
                  horizontal: "center"
                }}
              >
                &lt;Box style={{ margin: "20px" }} id="popover">
                  &lt;Typography style={{ fontWeight: "bold", color: "#37474f" }}>Share this deck&lt;/Typography>
                  &lt;Input defaultValue={`${window.location.href}`} readOnly={true} style={{ color: "#808080" }} />
                  &lt;Grid container direction="row" justify="flex-start" alignItems="center">
                    &lt;Box item flexGrow={1}>
                      &lt;Typography style={{ color: "#37474f" }}>{this.state.copiedLink ? "Copied!" : ""}&lt;/Typography>
                    &lt;/Box>
                    &lt;Button item color="secondary" style={{ fontWeight: "bold" }} onClick={() => this.handleCopyClick("popover")}>
                      Copy link
                    &lt;/Button>
                  &lt;/Grid>
                &lt;/Box>
              &lt;/Popover>

              &lt;Grid item xs={3} md={12} lg={6} container justify="center">
                {this.props.deckUi.deck.isCreator &amp;&amp; (
                  &lt;Button variant="text" color="primary" component={Link} to={`/editDeck/${this.props.deckId}`}>
                    &lt;EditIcon style={{ marginRight: "5px" }} />
                    &lt;Typography variant="body2">
                      Edit &lt;br /> Deck
                    &lt;/Typography>
                  &lt;/Button>
                )}
              &lt;/Grid>

              &lt;Grid item xs={3} md={12} lg={6} container justify="center">
                &lt;Button variant="text" color="primary" onClick={this.handleAddToCollection}>
                  &lt;LibraryAddIcon style={{ marginRight: "5px" }} />
                  &lt;Typography variant="body2">
                    Add to &lt;br /> Collection
                  &lt;/Typography>
                &lt;/Button>
              &lt;/Grid>
            &lt;/Grid>
          &lt;/Grid>
        )}
      &lt;/Grid>
    );
  }
}

DeckInfo.propTypes = {
  pinDeck: PropTypes.func.isRequired,
  unpinDeck: PropTypes.func.isRequired,
  openCollectionDialog: PropTypes.func.isRequired,
  deckUi: PropTypes.object.isRequired,
  uiStatus: PropTypes.object.isRequired,
  classes: PropTypes.object.isRequired
};

const mapStateToProps = state => ({
  deckUi: state.deckUi,
  uiStatus: state.uiStatus
});

const mapActionsToProps = {
  pinDeck,
  unpinDeck,
  openCollectionDialog
};

export default connect(mapStateToProps, mapActionsToProps)(withStyles(styles)(DeckInfo));
</code></pre>
              </article>
            </section>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Thu Apr 30 2020 14:39:47 GMT+0200 (GMT+02:00)</p>
        <p class="sidebar-created-by">
          <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
          <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
        </p>
      </div>
    </footer>

    <script src="scripts/app.min.js"></script>
    <script src="scripts/linenumber.js"></script>
  </body>
</html>
